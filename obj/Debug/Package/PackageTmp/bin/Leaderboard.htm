            <!doctype html>
            <html>
            <head>    
                <title id="Title">PGATop2 Leaderboard</title>    
                <meta name="viewport" content="width=device-width, initial-scale=1"> 
                <link rel="stylesheet"  href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
                <link rel="stylesheet"  href="../css/dwise.css" />
                <script src='http://code.jquery.com/jquery-1.8.2.min.js'></script>    
                <script src='../jquery.mobile-1.3.1/jquery.mobile-1.3.1.min.js'></script>
                 <script language="javascript">
                     $(document).bind('pagechange', function (event) {
                         $('.ui-page-active .eventHeader').text($.cookie("GolfEventName"));
                         $('.ui-page-active .teamHeader').text($.cookie("GolfTeamName"));
                     });

                     $(window).load(function () {
                         $.mobile.loading('show');
                     });


                     $(window).on("navigate", function (event, data) {
                        // debugger;
                         if (data.state) {
                             // Make use of the arbitrary data stored
                         }

//                         if (data.state.direction == "back") {
//                             // Make use of the directional information
//                             //loadXml('DraftResults', '');
//                             debugger;
//                             loadGolfers();
//                         }
                     });
                </script>


        </head>
            <body id="body">    
                <!-- TeamTop2 -->
                <div data-role='page' id="leaderboard"> 
                    <script src="../Scripts/LoadXml.js"></script>
                    <script src="../Scripts/Leaderboard.js"></script>
                    <script src="../Scripts/jquery.cookie.js"></script>
                    <script type="text/javascript">
                        $("#leaderboard").on('pageinit', function () {
                            // loadXml('Leaderboard', '');
                            loadGolfers($.cookie("GolfTeamId").toString());
                            loadGolfTeams($.cookie("GolfTeamId").toString());
                            $('#eventHeader').text($.cookie("GolfEventName").toString());
                        });

                        $("#leaderboard").on('pageshow', function () {
                            $('.ui-page-active :jqmData(role=collapsible)').collapsible();
                            $('.ui-page-active .ui-listview').listview('refresh');
                            $('.ui-page-active :jqmData(role=content)').trigger('create');
                            $('.ui-page-active :jqmData(role=header)').trigger('create');
                        });

//                        $("#leaderboard").on('pagebeforecreate', function () {
//                            $("#Div8").append($(jQuery(jQuery("#headerTemplate").html())));
//                        });

                        function loadGolfers(golfTeamId) {
                              //    debugger;
                            $.ajax(
                            {
                                beforeSend: function () { $.mobile.loading("show"); }, //Show spinner
                                complete: function () { $.mobile.loading("hide"); }, //Hide spinner
                                type: "GET",
                                datatype: "xml",
                                url: "../Golf.EventDraft.asmx/Leaderboard",
                                data: { GolfTeamId: golfTeamId },
                                success: function (xml) { xmlParser(xml); },
                                error: function (XMLHttpRequest, textStatus, errorThrown) {
                                    alert(errorThrown);
                                }
                            });
                        }

                        function xmlParser(xml, day) {
                            Leaderboard(xml);
                        }

                        function refreshPage() {
                            location.reload();
                        }

                        function betPopup(playerMatchupId, golfTeamId) {
                            // debugger;
                            $.mobile.changePage("puSideBet.htm?PlayerMatchupId=" + playerMatchupId + "&GolfTeamId=" + golfTeamId, { role: "dialog" });
                        }

                        function loadGolfTeams(golfTeamId) {
                            //   debugger;
                            $.ajax(
                        {
                            beforeSend: function () { $.mobile.loading("show"); }, //Show spinner
                            complete: function () { $.mobile.loading("hide"); }, //Hide spinner
                            type: "GET",
                            datatype: "xml",
                            url: "../Golf.EventDraft.asmx/GolfTeamDelegates",
                            data: { GolfTeamId: golfTeamId },
                            success: function (xml) {
                                populateGolfTeams(xml);
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                alert(errorThrown);
                            }
                        });
                        }

                        function populateGolfTeams(xml) {
                            var index = 0;
                            var i = 0;
                            var loggedInGolfTeamId = $.cookie("GolfTeamId").toUpperCase();
                            $(xml).find("GolfTeam").each(
                        function () {
                            var xmlGolfTeamId = $(this).find("GolfTeamId").first().text().toUpperCase();
                            var xmlGolfTeamName = $(this).find("GolfTeamName").first().text();

                            if (xmlGolfTeamId == loggedInGolfTeamId && $(this)[0].parentNode.nodeName == "GolfTeams") {
                                //Append Logged In Team First
                                $('#teamsappointed').append($('<option/>',
                                {
                                    'text': xmlGolfTeamName,
                                    'value': xmlGolfTeamId + ":" + xmlGolfTeamName
                                }));

                                //Append Delagated Teams
                                $(this).find("Delegates").find("GolfTeam").each(
                                function () {
                                    var dGolfTeamId = $(this).find("GolfTeamId").text().toUpperCase();
                                    var dGolfTeamName = $(this).find("GolfTeamName").text();
                                    $('#teamsappointed').append($('<option/>',
                                        {
                                            'text': dGolfTeamName,
                                            'value': dGolfTeamId + ":" + dGolfTeamName
                                        }));
                                });
                            }
                        });

                            var myselect = $("#teamsappointed");
                            myselect[0].selectedIndex = 0;
                            $('#teamsappointed').selectmenu('refresh');
                        }


                       

                    </script>
                    <div data-role='header' id="Div8" data-theme='e'>
                        <div data-role="navbar" data-theme ="e">
                            <ul class="custom-navbar ui-grid-e" >
                                <li><a href="javascript:history.go(-1)" data-icon="back" data-direction="reverse" data-mini="true">Back</a></li>
                                <li><a href="default.htm" rel="external" data-mini="true" data-icon="home">Home</a></li>
                                <li><a href="PlayerMatchups.htm" rel="external" data-mini="true" data-icon="plus" class="ui-icon-proposed" id="btnPlayerMatchup">Matchups</a></li>
                                <li></li>
                                <li><a href='javascript:refreshPage()' data-icon="refresh" data-mini="true">Refresh</a></li>
                            </ul>
                        </div>
                                
                        

                         <div  data-role='footer' class="ui-grid-a" style="height:60px">
                            <div id="eventHeader"  class="ui-block-a"></div> 
                            <div id="pageHeaderFooter1" class="ui-block-b">
                            <div data-role="fieldcontain"> 
                                        <select  class="select_choice" data-native-menu="false" id="teamsappointed">
                                        </select>
                                    </div>
                            </div>
                        </div>

                    </div>
                    <div data-role='content'>
                        <h3 id="title">Leaderboard</h3>
                        <ul data-role='listview' id="ulLeaderboard" data-inset='true' data-filter='true'  data-theme="c"></ul>
                    </div>
                    <div data-role='footer'></div>            
                </div>
                <script language = 'javascript'>
                    $("#teamsappointed").on("change", function () {
                       // debugger;
                        var GolfInfo = $(this).val().split(":");
                        $("#ulLeaderboard").empty();
                        loadGolfers(GolfInfo[0]);
                        $('.ui-page-active :jqmData(role=content)').trigger('create');
                    });
                </script>
              
                 
            </body>
        </html>
