<!DOCTYPE html> 
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Draft Confirmation</title> 
    <link rel="stylesheet"  href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src='http://code.jquery.com/jquery-1.8.2.min.js'></script>    
    <script src='../jquery.mobile-1.3.1/jquery.mobile-1.3.1.min.js'></script>
    <script src="../Scripts/jquery.cookie.js"></script>
    
    
     
    <script language = 'javascript'>
    $(document).ready(function () {
        //         $("#teamsappointed").on("change", function () {
        //            //debugger;
        //            // loadTeam($(this).val());
        //            var GolfInfo = $(this).val().split(":");
        //            $.cookie("GolfTeamId", GolfInfo[0], { expires: 1000, path: '/' });
        //            $.cookie("GolfTeamName", GolfInfo[1], { expires: 1000, path: '/' });
        //            $.mobile.changePage('default.htm', 'pop', true, true);

        //        });


        
    });

</script>
</head> 

<body> 
<div data-role="page" id="pDraft" data-close-btn="right" >
<script src="../Scripts/GetURLParameters.js"></script>
<script language = 'javascript'>
    $("#pDraft").on('pageinit', function () {
         debugger;
        var urlParameters = getUrlVarsPage('pMatchup');
        var GolferName;
        var Id;
        if (urlParameters != "") {
            if (urlParameters.Id != null) {
                Id = urlParameters.Id
            }

            if (urlParameters.GolferName != null) {
                GolferName = urlParameters.GolferName
            }
        }

        $('#golferName').text('Are you sure you want to draft ' + GolferName + "?");

        $('#draftApproved').click(draftGolfer(Id));
    });

    function draftGolfer(Id) {
                $.ajax(s
                    {
                        beforeSend: function () { $.mobile.showPageLoadingMsg("e", "Drafting Golfer..."); }, //Show spinner
                        complete: function () { $.mobile.hidePageLoadingMsg() }, //Hide spinner
                        type: "POST",
                        datatype: "xml",
                        async: false,
                        cache: false,
                        url: "../Golf.EventDraft.asmx/DraftGolfer",
                        data: { EventOddsId: Id, GolfTeamId: $.cookie("GolfTeamId").toString() },
                        success: function (xml) {
                            $.mobile.hidePageLoadingMsg();
                            $.cookie("previousUrl", window.location.href, { path: "/" });
                            $.cookie("LastDraftPick", Id, { path: "/" });
                            var url = "/";
                            $(location).attr('href', url);
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            alert("Local Error");
                            $.mobile.changePage("default.html");
                        }
                    });
    }
   
</script>
    <div data-role="header" data-theme="d" >
        <h3>Draft Pick</h3>
    </div>

    <div data-role="content" data-theme="c" >
            <div >
                <h4 id="golferName"></h4>
                <p></p>
            </div>
            <div>
                <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="c" id="draftCancel">Cancel</a>    
                <a href="default.htm" data-role="button" data-inline="true" data-rel="back" data-transition="flow" data-theme="b" id="draftApproved">Draft</a>  
            </div>
        </div>
	</div>
</body>
</html>
