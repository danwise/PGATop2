<!doctype html>
            <html>
            <head>    
                <title>Travelers Championship</title>    
                <meta name='viewport' content='width=device-width, initial-scale=1'>    
                <link rel="stylesheet"  href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
                <script src='http://code.jquery.com/jquery-1.8.2.min.js'></script>    
                <script src='../jquery.mobile-1.3.1/jquery.mobile-1.3.1.min.js'></script>
                </script>
                
            </head>
<body>    
                <div data-role='page' id="indexPageDraftResults" data-fetch='always'>   
                <script src="../Scripts/jquery.cookie.js"></script>
                <script type="text/javascript">
                    $("#indexPageDraftResults").on('pageinit', function () {
                        //debugger;
                        $("#pageHeaderHeaderDraftResults").append($('<h4/>', { 'text': $.cookie("GolfEventName") }).css("text-align", "left"));
                        $("#pageHeaderFooterDraftResults").append($('<h6/>', { 'text': $.cookie("GolfTeamName") }).css("text-align", "right").css("padding-right", "1cm"));
                        loadGolfers();
                    });

                    //                    var mainloaded = false;

                    //                    $('#indexPageDraftResults').on('pageshow', function (event) {   //Workaround to show page loading on initial page load
                    //                        if (!mainloaded) {
                    //                            $.mobile.showPageLoadingMsg();
                    //                        }
                    //                    });

                    function loadGolfers() {
                        //debugger;
                        $.ajax(
                        {
                            beforeSend: function () { $.mobile.showPageLoadingMsg(); }, //Show spinner
                            complete: function () { $.mobile.hidePageLoadingMsg() }, //Hide spinner
                            type: "POST",
                            datatype: "xml",
                            url: "../Golf.EventDraft.asmx/DraftResults",
                            data: {},
                            success: function (xml) { xmlParser(xml); },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                alert(errorThrown);
                            }
                        });


                    }

                    function xmlParser(xml) {
                        $(xml).find("EventDraft").sort(function (a, b) {
                            var aDraftPick = parseInt(a.getElementsByTagName("PickNumber")[a.getElementsByTagName("PickNumber").length - 1].childNodes[0].nodeValue);
                            var bDraftPick = parseInt(b.getElementsByTagName("PickNumber")[b.getElementsByTagName("PickNumber").length - 1].childNodes[0].nodeValue);
                            if (aDraftPick > bDraftPick) return -1;
                            if (aDraftPick < bDraftPick) return 1;
                            return 0
                        }).each(
                        function () {
                            $("#draftResults")
                            .append($('<li/>', {})
                                .append($('<a/>',
                                {
                                    'href': '#',
                                    'data-transition': 'slide'
                                })
                                .append($('<img/>',
                                {
                                    'src': $(this).find("GolferImgUrl").text()
                                }))
                                .append($('<h3/>',
                                {
                                    'text': $(this).find("PickNumber").text() + ". " + $(this).find("Golfer").text()
                                }))
                                .append($('<p/>',
                                {
                                    'text': $(this).find("GolfTeam").text()
                                }))));
                        })

                        $('#draftResults').listview('refresh');
                    }
        </script>      
                <div data-role='header' id="pageHeader" data-theme='e'> 
                <div data-role="navbar">
                    <a data-role="button"  data-icon="home" data-direction="reverse" href="http://www.dwise.net">Home</a>
                    <a data-role="button"  data-icon="back" data-direction="reverse" href="javascript:history.go(-1)">Back</a>
                    <a href='javascript:location.reload()' data-role="button" data-icon="refresh"  >Refresh</a>
                    </div>
                    <div  data-role='footer' class="ui-grid-b" style="height:40px">
                        <div id="pageHeaderHeaderDraftResults"  class="ui-block-a"></div> 
                        <div id="Div1" class="ui-block-b" style="text-align:center"><h4>Draft Room</h4></div>
                        <div id="pageHeaderFooterDraftResults" class="ui-block-b"></div>
                    </div>
                </div>
                <div data-role='content' id="content">
                    <div data-role='content-primary' >
                        <ul data-role='listview' id="draftResults" data-inset='true' data-filter='true'  data-theme="c" />
                    </div>
                </div>
                <div data-role='footer'/>            
              </div>
            </body>
        </html>
